name: 'Create deploy branch'

on:
  workflow_dispatch:
  push:
    branches:
      - main
      - develop
  pull_request:

permissions:
  contents: read, write
  # Needed for the 'trilom/file-changes-action' action
  pull-requests: read

jobs:
  refresh-deploy:
    runs-on: ${{ fromJSON('["ubuntu-latest", "self-hosted"]')[github.repository == 'github/docs-internal'] }}
    steps:
      - name: Checkout
        uses: actions/checkout@v3
        with:
            ref: deploy
      - name: Run Script
        shell: bash
        run: |
          rm -r develop;
          rm -r main;
          git clone --branch main https://github.com/tektektek2000/TrelloPowerUp.git main
          git clone --branch develop https://github.com/tektektek2000/TrelloPowerUp.git develop
          rm -r main/.git
          rm -r develop/.git
          git add --all
          git commit -m "deploy"
          git push
          
